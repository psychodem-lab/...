<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PoÅ‚Ä…cz 15 PunktÃ³w</title>
    <style>
        /* CSS: Ustawienia dla responsywnoÅ›ci i wyglÄ…du */
        :root {
            /* Zmienne CSS do uÅ‚atwienia zmian kolorÃ³w */
            --color-primary: #007bff; /* Kolor linii i ramki */
            --color-success: #28a745; /* Kolor poÅ‚Ä…czonych punktÃ³w */
            --color-default: #6c757d; /* Kolor niepoÅ‚Ä…czonych punktÃ³w */
        }

        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            margin: 20px;
            padding: 0;
            text-align: center;
        }

        h1 {
            color: #333;
        }

        /* Ustawienie pÅ‚Ã³tna jako responsywnego */
        canvas {
            /* Maksymalny rozmiar na duÅ¼ych ekranach */
            max-width: 600px; 
            max-height: 400px;
            
            /* Skalowanie na mniejszych ekranach */
            width: 90vw; 
            height: 60vw; /* 90vw * (400/600) = 60vw, aby zachowaÄ‡ proporcje */

            border: 2px solid var(--color-primary);
            background-color: white;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            /* Zapewnienie, Å¼e dotykanie jest Å‚atwe na mobilnych */
            touch-action: manipulation;
        }

        #info {
            margin-top: 15px;
            padding: 10px 20px;
            font-size: 1.1em;
            color: var(--color-success);
            font-weight: bold;
            background-color: #e2ffe8;
            border-radius: 5px;
        }
    </style>
</head>
<body>

    <h1>PoÅ‚Ä…cz Kropki!</h1>
    <p>Sekwencja: 1 â†’ A â†’ 2 â†’ B â†’ ... â†’ 8</p>
    
    <canvas id="gameCanvas" width="600" height="400"></canvas>
    
    <div id="info">Kliknij punkt startowy (1)</div>

    <script>
        // JavaScript: Logika Gry
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const infoDiv = document.getElementById('info');

        // WewnÄ™trzne wymiary Canvas (staÅ‚e, wzglÄ™dem ktÃ³rych zdefiniowano punkty)
        const CANVAS_WIDTH = canvas.width;
        const CANVAS_HEIGHT = canvas.height;

        // PromieÅ„ punktu (wiÄ™kszy dla lepszej precyzji klikniÄ™cia na urzÄ…dzeniach mobilnych)
        const POINT_RADIUS = 18;
        const FONT_SIZE = '16px';

        // Definicja 15 punktÃ³w (1, A, 2, B, ..., 7, G, 8)
        const points = [
            // 1
            { x: 100, y: 50, label: '1' },
            // A
            { x: 500, y: 50, label: 'A' },
            // 2
            { x: 550, y: 200, label: '2' },
            // B
            { x: 400, y: 350, label: 'B' },
            // 3
            { x: 200, y: 350, label: '3' },
            // C
            { x: 50, y: 200, label: 'C' },
            // 4
            { x: 150, y: 150, label: '4' },
            // D
            { x: 450, y: 150, label: 'D' },
            // 5
            { x: 450, y: 250, label: '5' },
            // E
            { x: 150, y: 250, label: 'E' },
            // 6
            { x: 300, y: 75, label: '6' },
            // F
            { x: 300, y: 325, label: 'F' },
            // 7
            { x: 225, y: 200, label: '7' },
            // G
            { x: 375, y: 200, label: 'G' },
            // 8 (Centralny, ostatni)
            { x: 300, y: 200, label: '8' }
        ];

        let currentPointIndex = 0; // Oczekiwany punkt do klikniÄ™cia
        let connections = [];      // Przechowuje narysowane poÅ‚Ä…czenia

        // Funkcja rysujÄ…ca wszystkie elementy
        function draw() {
            ctx.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);

            // Rysuj poÅ‚Ä…czenia (linie)
            ctx.strokeStyle = getComputedStyle(document.documentElement).getPropertyValue('--color-primary');
            ctx.lineWidth = 4;
            ctx.beginPath();
            connections.forEach(conn => {
                ctx.moveTo(conn.start.x, conn.start.y);
                ctx.lineTo(conn.end.x, conn.end.y);
            });
            ctx.stroke();
            ctx.closePath();

            // Rysuj punkty i ich etykiety
            points.forEach((point, index) => {
                const isConnected = index < currentPointIndex;

                // Ustaw kolor: Zielony jeÅ›li poÅ‚Ä…czony, Szary jeÅ›li oczekujÄ…cy
                ctx.fillStyle = isConnected 
                    ? getComputedStyle(document.documentElement).getPropertyValue('--color-success') 
                    : getComputedStyle(document.documentElement).getPropertyValue('--color-default');
                
                // Rysuj okrÄ…g
                ctx.beginPath();
                ctx.arc(point.x, point.y, POINT_RADIUS, 0, Math.PI * 2);
                ctx.fill();

                // Rysuj etykietÄ™ (tekst)
                ctx.fillStyle = 'white'; // BiaÅ‚y tekst na kolorowym kÃ³Å‚ku
                ctx.font = `${FONT_SIZE} Arial`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(point.label, point.x, point.y);
            });
        }

        // Funkcja obsÅ‚ugujÄ…ca klikniÄ™cie (dla myszy i dotyku)
        function handleInteraction(event) {
            // Zapobieganie domyÅ›lnym zdarzeniom dotyku, takim jak przewijanie
            if (event.type === 'touchstart') {
                event.preventDefault();
            }

            const rect = canvas.getBoundingClientRect();
            // UÅ¼ywamy event.touches[0] dla dotyku i event dla myszy
            const clientX = event.touches ? event.touches[0].clientX : event.clientX;
            const clientY = event.touches ? event.touches[0].clientY : event.clientY;

            // WzglÄ™dne wspÃ³Å‚rzÄ™dne klikniÄ™cia/dotkniÄ™cia na widocznym canvasie
            const clickX = clientX - rect.left;
            const clickY = clientY - rect.top;

            // Skalowanie wspÃ³Å‚rzÄ™dnych do wewnÄ™trznego systemu (600x400)
            const scaleX = CANVAS_WIDTH / rect.width;
            const scaleY = CANVAS_HEIGHT / rect.height;

            const mouseX = clickX * scaleX;
            const mouseY = clickY * scaleY;

            // SprawdÅº, czy gra jest juÅ¼ zakoÅ„czona
            if (currentPointIndex === points.length) {
                return;
            }

            const expectedPoint = points[currentPointIndex];
            
            // Oblicz odlegÅ‚oÅ›Ä‡ od centrum oczekiwanego punktu w wewnÄ™trznym systemie
            const distance = Math.sqrt(
                Math.pow(mouseX - expectedPoint.x, 2) + Math.pow(mouseY - expectedPoint.y, 2)
            );

            // SprawdÅº trafienie
            if (distance < POINT_RADIUS) {
                // Poprawne klikniÄ™cie
                if (currentPointIndex > 0) {
                    const previousPoint = points[currentPointIndex - 1];
                    connections.push({ start: previousPoint, end: expectedPoint });
                }

                currentPointIndex++;

                // Warunek zwyciÄ™stwa
                if (currentPointIndex === points.length) {
                    infoDiv.textContent = 'GRATULACJE! Wszystkie 15 punktÃ³w poÅ‚Ä…czone! ðŸ¥³';
                    // Opcjonalne ponowne rysowanie w finalnym stylu
                    drawFinalLine();
                    
                } else {
                    infoDiv.textContent = `PoÅ‚Ä…czono! NastÄ™pny: (${points[currentPointIndex].label})`;
                }

                draw();
            } else {
                // Niepoprawne klikniÄ™cie
                infoDiv.textContent = `Nie ten punkt. Oczekiwany: (${expectedPoint.label})`;
            }
        }

        // Funkcja rysujÄ…ca ostatecznÄ… figurÄ™
        function drawFinalLine() {
            ctx.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT); // CzyÅ›cimy przed finalnym rysowaniem
            
            // Rysujemy poÅ‚Ä…czone punkty (zielone)
            points.forEach(point => {
                ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--color-success');
                ctx.beginPath();
                ctx.arc(point.x, point.y, POINT_RADIUS, 0, Math.PI * 2);
                ctx.fill();
                
                // Etykiety
                ctx.fillStyle = 'white';
                ctx.font = `${FONT_SIZE} Arial`;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(point.label, point.x, point.y);
            });

            // Rysujemy finalnÄ… liniÄ™ (np. czerwonÄ…, grubszÄ…)
            ctx.strokeStyle = '#dc3545'; // Finalny, inny kolor
            ctx.lineWidth = 5;
            ctx.beginPath();
            
            points.forEach((point, index) => {
                if (index === 0) {
                    ctx.moveTo(point.x, point.y);
                } else {
                    ctx.lineTo(point.x, point.y);
                }
            });
            
            ctx.stroke();
        }


        // INICJALIZACJA: Rysowanie poczÄ…tkowe i dodanie sÅ‚uchaczy zdarzeÅ„
        draw();
        
        // ObsÅ‚uga klikniÄ™cia myszy
        canvas.addEventListener('click', handleInteraction);
        
        // ObsÅ‚uga dotyku (dla urzÄ…dzeÅ„ mobilnych)
        canvas.addEventListener('touchstart', handleInteraction); 
    </script>

</body>
</html>
